var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function l(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n||null)}function r(t){t.parentNode&&t.parentNode.removeChild(t)}function i(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function h(){return f(" ")}function p(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function d(t,e){e=""+e,t.data!==e&&(t.data=e)}function _(t,e){t.value=null==e?"":e}let g;function y(t){g=t}function w(t){(function(){if(!g)throw new Error("Function called outside component initialization");return g})().$$.on_mount.push(t)}const b=[],k=[];let v=[];const $=[],x=Promise.resolve();let A=!1;function E(t){v.push(t)}const C=new Set;let R=0;function j(){if(0!==R)return;const t=g;do{try{for(;R<b.length;){const t=b[R];R++,y(t),O(t.$$)}}catch(t){throw b.length=0,R=0,t}for(y(null),b.length=0,R=0;k.length;)k.pop()();for(let t=0;t<v.length;t+=1){const e=v[t];C.has(e)||(C.add(e),e())}v.length=0}while(b.length);for(;$.length;)$.pop()();A=!1,C.clear(),y(t)}function O(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(E)}}const M=new Set;function P(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];v.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),v=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function S(t,e){-1===t.$$.dirty[0]&&(b.push(t),A||(A=!0,x.then(j)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function D(a,c,s,i,u,f,h,p=[-1]){const m=g;y(a);const d=a.$$={fragment:null,ctx:[],props:f,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c.context||(m?m.$$.context:[])),callbacks:n(),dirty:p,skip_bound:!1,root:c.target||m.$$.root};h&&h(d.root);let _=!1;if(d.ctx=s?s(a,c.props||{},((t,e,...n)=>{const o=n.length?n[0]:e;return d.ctx&&u(d.ctx[t],d.ctx[t]=o)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](o),_&&S(a,t)),e})):[],d.update(),_=!0,o(d.before_update),d.fragment=!!i&&i(d.ctx),c.target){if(c.hydrate){const t=function(t){return Array.from(t.childNodes)}(c.target);d.fragment&&d.fragment.l(t),t.forEach(r)}else d.fragment&&d.fragment.c();c.intro&&((w=a.$$.fragment)&&w.i&&(M.delete(w),w.i(b))),function(t,n,a,c){const{fragment:s,after_update:r}=t.$$;s&&s.m(n,a),c||E((()=>{const n=t.$$.on_mount.map(e).filter(l);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),r.forEach(E)}(a,c.target,c.anchor,c.customElement),j()}var w,b;y(m)}class N{$destroy(){P(this,1),this.$destroy=t}$on(e,n){if(!l(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function B(t,e,n){const o=t.slice();return o[73]=e[n],o[75]=n,o}function T(t,e,n){const o=t.slice();return o[76]=e[n],o[78]=n,o}function L(t,e,n){const o=t.slice();return o[79]=e[n],o[78]=n,o}function Y(t,e,n){const o=t.slice();return o[73]=e[n],o[75]=n,o}function U(t,e,n){const o=t.slice();return o[73]=e[n],o[75]=n,o}function z(t,e,n){const o=t.slice();return o[83]=e[n],o[78]=n,o}function G(t){let e,n,o,l,a=t[83].tag+"";function i(){return t[34](t[83])}return{c(){e=u("button"),n=f(a)},m(t,a){s(t,e,a),c(e,n),o||(l=p(e,"click",i),o=!0)},p(e,o){t=e,2&o[0]&&a!==(a=t[83].tag+"")&&d(n,a)},d(t){t&&r(e),o=!1,l()}}}function Q(t){let e,n;return{c(){e=u("option"),e.__value=n=t[73].tag,e.value=e.__value},m(t,n){s(t,e,n)},p(t,o){256&o[0]&&n!==(n=t[73].tag)&&(e.__value=n,e.value=e.__value)},d(t){t&&r(e)}}}function q(e){let n;return{c(){n=u("span"),n.textContent="😇"},m(t,e){s(t,n,e)},p:t,d(t){t&&r(n)}}}function F(t){let e,n,a,i,m,_,g,y,w,b,k=t[79].reply+"",v=t[79].username+"";function $(){return t[41](t[79])}return{c(){e=u("li"),n=f(k),a=h(),i=u("button"),m=f(v),_=h(),g=u("button"),g.textContent="fetch_delete_comment_reply",y=h()},m(o,r){s(o,e,r),c(e,n),c(e,a),c(e,i),c(i,m),c(e,_),c(e,g),s(o,y,r),w||(b=[p(i,"click",$),p(g,"click",(function(){l(t[21](t[79].id))&&t[21](t[79].id).apply(this,arguments)}))],w=!0)},p(e,o){t=e,2&o[0]&&k!==(k=t[79].reply+"")&&d(n,k),2&o[0]&&v!==(v=t[79].username+"")&&d(m,v)},d(t){t&&r(e),t&&r(y),w=!1,o(b)}}}function H(t){let e,n,a,g,y,w,b,k,v,$,x,A,E,C,R,j,O,M=t[76][t[78]].comment+"",P=t[76][t[78]].username+"";function S(){return t[39](t[76],t[78])}let D=t[76].comment_replies,N=[];for(let e=0;e<D.length;e+=1)N[e]=F(L(t,D,e));return{c(){e=u("li"),n=f(M),a=h(),g=u("button"),y=f(P),w=h(),b=u("button"),b.textContent="fetch_delete_comment",k=h(),v=u("input"),$=h(),x=u("button"),x.textContent="fetch_insert_comment_reply",A=h(),E=u("li"),C=u("ul");for(let t=0;t<N.length;t+=1)N[t].c();R=h(),m(v,"type","text"),m(v,"placeholder","comment_reply"),m(E,"class","reply_zone svelte-1mb8pst")},m(o,r){s(o,e,r),c(e,n),c(e,a),c(e,g),c(g,y),c(e,w),c(e,b),s(o,k,r),s(o,v,r),_(v,t[6]),s(o,$,r),s(o,x,r),s(o,A,r),s(o,E,r),c(E,C);for(let t=0;t<N.length;t+=1)N[t]&&N[t].m(C,null);s(o,R,r),j||(O=[p(g,"click",S),p(b,"click",(function(){l(t[19](t[76][t[78]].id))&&t[19](t[76][t[78]].id).apply(this,arguments)})),p(v,"input",t[40]),p(x,"click",(function(){l(t[20](t[76][t[78]].id))&&t[20](t[76][t[78]].id).apply(this,arguments)}))],j=!0)},p(e,o){if(t=e,2&o[0]&&M!==(M=t[76][t[78]].comment+"")&&d(n,M),2&o[0]&&P!==(P=t[76][t[78]].username+"")&&d(y,P),64&o[0]&&v.value!==t[6]&&_(v,t[6]),136314882&o[0]){let e;for(D=t[76].comment_replies,e=0;e<D.length;e+=1){const n=L(t,D,e);N[e]?N[e].p(n,o):(N[e]=F(n),N[e].c(),N[e].m(C,null))}for(;e<N.length;e+=1)N[e].d(1);N.length=D.length}},d(t){t&&r(e),t&&r(k),t&&r(v),t&&r($),t&&r(x),t&&r(A),t&&r(E),i(N,t),t&&r(R),j=!1,o(O)}}}function I(t){let e,n,a,g,y,w,b,k,v,$,x,A,E,C,R,j,O,M,P,S,D,N,B,L,F,I,J,V,K,W,X,Z,tt,et,nt,ot,lt,at=t[73].link+"",ct=t[73].username+"",st=t[73].tags,rt=[];for(let e=0;e<st.length;e+=1)rt[e]=G(z(t,st,e));let it=t[8],ut=[];for(let e=0;e<it.length;e+=1)ut[e]=Q(U(t,it,e));function ft(){return t[37](t[73])}let ht=t[73].likes,pt=[];for(let e=0;e<ht.length;e+=1)pt[e]=q(Y(t,ht,e));let mt=t[73].comments_and_replies,dt=[];for(let e=0;e<mt.length;e+=1)dt[e]=H(T(t,mt,e));return{c(){e=u("br"),n=h(),a=u("br"),g=h(),y=u("li"),w=u("div");for(let t=0;t<rt.length;t+=1)rt[t].c();b=h(),k=u("div"),v=u("input"),$=h(),x=u("datalist");for(let t=0;t<ut.length;t+=1)ut[t].c();A=h(),E=u("button"),E.textContent="fetch_insert_tag",C=h(),R=u("ul"),j=u("li"),O=u("a"),M=f(at),S=h(),D=u("button"),D.textContent="fetch_delete_link",N=h(),B=u("button"),L=f(ct),F=h();for(let t=0;t<pt.length;t+=1)pt[t].c();I=h(),J=u("button"),J.textContent="like_increment_or_decrement",V=h(),K=u("div"),W=u("input"),X=h(),Z=u("button"),Z.textContent="fetch_insert_comment",tt=h(),et=u("ul");for(let t=0;t<dt.length;t+=1)dt[t].c();nt=h(),m(w,"class","svelte-1mb8pst"),m(v,"list","autocomplete_list"),m(v,"type","text"),m(v,"name",""),m(v,"placeholder","tag"),m(x,"id","autocomplete_list"),m(k,"class","svelte-1mb8pst"),m(O,"href",P=t[73].link),m(O,"target","_blank"),m(O,"class","link_text svelte-1mb8pst"),m(W,"type","text"),m(W,"name",""),m(W,"placeholder","comment"),m(K,"class","svelte-1mb8pst"),m(et,"class","comment_zone svelte-1mb8pst")},m(o,r){s(o,e,r),s(o,n,r),s(o,a,r),s(o,g,r),s(o,y,r),c(y,w);for(let t=0;t<rt.length;t+=1)rt[t]&&rt[t].m(w,null);c(y,b),c(y,k),c(k,v),t[35](v),_(v,t[7]),c(k,$),c(k,x);for(let t=0;t<ut.length;t+=1)ut[t]&&ut[t].m(x,null);c(k,A),c(k,E),c(y,C),c(y,R),c(R,j),c(j,O),c(O,M),c(j,S),c(j,D),c(y,N),c(y,B),c(B,L),c(y,F);for(let t=0;t<pt.length;t+=1)pt[t]&&pt[t].m(y,null);c(y,I),c(y,J),c(y,V),c(y,K),c(K,W),_(W,t[5]),c(K,X),c(K,Z),c(y,tt),c(y,et);for(let t=0;t<dt.length;t+=1)dt[t]&&dt[t].m(et,null);c(y,nt),ot||(lt=[p(v,"input",t[36]),p(v,"input",t[23]),p(E,"click",(function(){l(t[22](t[73].id))&&t[22](t[73].id).apply(this,arguments)})),p(D,"click",(function(){l(t[16](t[73].id))&&t[16](t[73].id).apply(this,arguments)})),p(B,"click",ft),p(J,"click",(function(){l(t[17](t[73].id))&&t[17](t[73].id).apply(this,arguments)})),p(W,"input",t[38]),p(Z,"click",(function(){l(t[18](t[73].id))&&t[18](t[73].id).apply(this,arguments)}))],ot=!0)},p(e,n){if(t=e,67108866&n[0]){let e;for(st=t[73].tags,e=0;e<st.length;e+=1){const o=z(t,st,e);rt[e]?rt[e].p(o,n):(rt[e]=G(o),rt[e].c(),rt[e].m(w,null))}for(;e<rt.length;e+=1)rt[e].d(1);rt.length=st.length}if(128&n[0]&&v.value!==t[7]&&_(v,t[7]),256&n[0]){let e;for(it=t[8],e=0;e<it.length;e+=1){const o=U(t,it,e);ut[e]?ut[e].p(o,n):(ut[e]=Q(o),ut[e].c(),ut[e].m(x,null))}for(;e<ut.length;e+=1)ut[e].d(1);ut.length=it.length}if(2&n[0]&&at!==(at=t[73].link+"")&&d(M,at),2&n[0]&&P!==(P=t[73].link)&&m(O,"href",P),2&n[0]&&ct!==(ct=t[73].username+"")&&d(L,ct),2&n[0]){let e;for(ht=t[73].likes,e=0;e<ht.length;e+=1){const o=Y(t,ht,e);pt[e]?pt[e].p(o,n):(pt[e]=q(),pt[e].c(),pt[e].m(y,I))}for(;e<pt.length;e+=1)pt[e].d(1);pt.length=ht.length}if(32&n[0]&&W.value!==t[5]&&_(W,t[5]),137887810&n[0]){let e;for(mt=t[73].comments_and_replies,e=0;e<mt.length;e+=1){const o=T(t,mt,e);dt[e]?dt[e].p(o,n):(dt[e]=H(o),dt[e].c(),dt[e].m(et,null))}for(;e<dt.length;e+=1)dt[e].d(1);dt.length=mt.length}},d(l){l&&r(e),l&&r(n),l&&r(a),l&&r(g),l&&r(y),i(rt,l),t[35](null),i(ut,l),i(pt,l),i(dt,l),ot=!1,o(lt)}}}function J(e){let n,l,a,g,y,w,b,k,v,$,x,A,E,C,R,j,O,M,P,S,D,N,T,L,Y,U,z,G,Q,q,F,H,J,V,K,W,X,Z,tt,et,nt,ot,lt,at,ct,st,rt,it,ut,ft=e[1],ht=[];for(let t=0;t<ft.length;t+=1)ht[t]=I(B(e,ft,t));return{c(){n=f("name: "),l=u("input"),a=f("\npassword: "),g=u("input"),y=h(),w=u("div"),b=f("link: "),k=u("input"),v=h(),$=u("button"),$.textContent="insert_link",x=h(),A=u("button"),A.textContent="CLEAR",E=h(),C=u("button"),R=f("ORDER_BY: "),j=f(e[10]),O=h(),M=u("button"),P=f("ORDER_BY_COLUMN: "),S=f(e[11]),D=h(),N=u("div"),T=h(),L=u("ul");for(let t=0;t<ht.length;t+=1)ht[t].c();var t,o,c,s;Y=h(),U=u("br"),z=h(),G=u("button"),G.textContent="toggle_footer",Q=h(),q=u("footer"),F=u("p"),F.textContent="Version 0.0.0.1",H=h(),J=u("p"),J.textContent="client side hosting: ",V=u("a"),V.textContent="https://taroyanaka.github.io/svelte/",K=h(),W=u("p"),W.textContent="server side hosting: ",X=u("a"),X.textContent="https://glitch.com/edit/#!/spectrum-whip-sulfur?path=server.js%3A3%3A0",Z=h(),tt=u("p"),tt.textContent="client side source code: ",et=u("p"),et.innerHTML='<a href="https://github.com/taroyanaka/svelte/">https://github.com/taroyanaka/svelte/</a> \n  ',nt=u("p"),nt.textContent="server side source code: ",ot=u("p"),lt=u("a"),lt.textContent="https://github.com/taroyanaka/duct/",at=h(),ct=u("button"),st=f("list_only_safe: "),rt=f(e[0]),m(l,"type","text"),m(l,"placeholder","name"),m(g,"type","password"),m(g,"placeholder","password"),m(k,"type","text"),m(k,"placeholder","link_url"),m(k,"class","link"),m($,"class","insert_link"),m(w,"class","svelte-1mb8pst"),m(N,"class","svelte-1mb8pst"),m(V,"href","https://taroyanaka.github.io/svelte/"),m(X,"href","https://glitch.com/edit/#!/spectrum-whip-sulfur?path=server.js%3A3%3A0"),m(lt,"href","https://github.com/taroyanaka/duct/"),m(q,"class","footer_open"),m(q,"id","footer"),t=q,o="display",null==(c="block")?t.style.removeProperty(o):t.style.setProperty(o,c,s?"important":"")},m(t,o){s(t,n,o),s(t,l,o),_(l,e[2]),s(t,a,o),s(t,g,o),_(g,e[3]),s(t,y,o),s(t,w,o),c(w,b),c(w,k),_(k,e[4]),c(w,v),c(w,$),c(w,x),c(w,A),c(w,E),c(w,C),c(C,R),c(C,j),c(w,O),c(w,M),c(M,P),c(M,S),s(t,D,o),s(t,N,o),s(t,T,o),s(t,L,o);for(let t=0;t<ht.length;t+=1)ht[t]&&ht[t].m(L,null);s(t,Y,o),s(t,U,o),s(t,z,o),s(t,G,o),s(t,Q,o),s(t,q,o),c(q,F),c(q,H),c(q,J),c(q,V),c(q,K),c(q,W),c(q,X),c(q,Z),c(q,tt),c(q,et),c(q,nt),c(q,ot),c(ot,lt),c(ot,at),c(ot,ct),c(ct,st),c(ct,rt),it||(ut=[p(l,"input",e[28]),p(g,"input",e[29]),p(k,"input",e[30]),p($,"click",e[15]),p(A,"click",e[31]),p(C,"click",e[32]),p(M,"click",e[33]),p(G,"click",e[13]),p(ct,"click",e[42])],it=!0)},p(t,e){if(4&e[0]&&l.value!==t[2]&&_(l,t[2]),8&e[0]&&g.value!==t[3]&&_(g,t[3]),16&e[0]&&k.value!==t[4]&&_(k,t[4]),1024&e[0]&&d(j,t[10]),2048&e[0]&&d(S,t[11]),218039266&e[0]){let n;for(ft=t[1],n=0;n<ft.length;n+=1){const o=B(t,ft,n);ht[n]?ht[n].p(o,e):(ht[n]=I(o),ht[n].c(),ht[n].m(L,null))}for(;n<ht.length;n+=1)ht[n].d(1);ht.length=ft.length}1&e[0]&&d(rt,t[0])},i:t,o:t,d(t){t&&r(n),t&&r(l),t&&r(a),t&&r(g),t&&r(y),t&&r(w),t&&r(D),t&&r(N),t&&r(T),t&&r(L),i(ht,t),t&&r(Y),t&&r(U),t&&r(z),t&&r(G),t&&r(Q),t&&r(q),it=!1,o(ut)}}}let V="https://spectrum-whip-sulfur.glitch.me/";function K(t,e,n){let o=!0;const l=async()=>{console.log("change_list_safe"),n(0,o=!o),await v({})};let a,c=[],s="user1",r="user_pass1",i="https://yanaka.dev/",u="comment1",f="reply1",h="tag1",p=[],m="",d="ASC",_="id",g="",y="",b="";const v=async({ORDER_BY_PARAM:t="DESC",ORDER_BY_COLUMN_PARAM:e="id",REQ_TAG_PARAM:l,USER_PARAM:a})=>{console.log(e);try{n(10,d=t),n(11,_=e),g=l,y=a;const s=()=>{const t=[];d&&t.push(`order_by=${d}`),_&&t.push(`order_by_column=${_}`),g&&t.push(`tag=${g}`),y&&t.push(`user=${y}`);return`${V+"read_all"}?${t.join("&")}`},r=await(await fetch(s())).json();if("fail"===r.result)throw new Error(r.error);const i=await(await fetch(s())).json();if(0===i.length)throw new Error("条件に一致するデータがありませんでした");n(1,c=i.message),n(1,c=(t=>{const e=t.filter((t=>!(t.link.includes("tktube")||t.link.includes("7mmtv")||t.link.includes("musescore")||t.link.includes("youtube"))));return o?e:t})(c)),console.log("done")}catch(t){console.log(t),t.message}},$=t=>({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),x=async t=>{try{200===t.status&&(b=t.result),"fail"===t.result||400===t.status?(()=>{throw new Error(t.message)})():await v({})}catch(t){(()=>{throw new Error(t.message)})()}},A=async()=>{console.log("fetch_get_tags_for_autocomplete");const t=await(await fetch(V+"get_tags_for_autocomplete",$({name:s,password:r}))).json(),e=await t;n(8,p=await e.message),console.log(p)},E=async()=>{switch(!0){case"id"===_:n(11,_="created_at");break;case"created_at"===_:n(11,_="updated_at");break;default:n(11,_="id")}await v({ORDER_BY_PARAM:d,ORDER_BY_COLUMN_PARAM:_,REQ_TAG_PARAM:"TEST"})},C=async()=>{switch(!0){case"ASC"===d:n(10,d="DESC");break;case"DESC"===d:n(10,d="ASC");break;default:n(11,_="DESC")}await v({ORDER_BY_PARAM:d,ORDER_BY_COLUMN_PARAM:_})},R=async t=>{g=t,await v({REQ_TAG_PARAM:g})},j=async t=>{const e=t||"user1";await v({USER_PARAM:e})};w((async()=>{try{await v({}),await A()}catch(t){console.log(t)}}));return[o,c,s,r,i,u,f,h,p,m,d,_,l,()=>{const t=document.getElementById("footer");t.style=t.className.includes("footer_open")?"display: none;":"display: block;",t.className=t.className.includes("footer_open")?"footer_close":"footer_open"},v,async()=>{try{a=await(await fetch(V+"insert_link",$({name:s,password:r,link:i}))).json(),await x(a)}catch(t){t.message}},async t=>{try{a=await(await fetch(V+"delete_link",$({name:s,password:r,id:t}))).json(),await x(a)}catch(t){t.message}},async t=>{try{a=await(await fetch(V+"like_increment_or_decrement",$({name:s,password:r,link_id:t}))).json(),await x(a)}catch(t){t.message}},async t=>{try{a=await(await fetch(V+"insert_comment",$({name:s,password:r,link_id:t,comment:u}))).json(),await x(a)}catch(t){t.message}},async t=>{try{a=await(await fetch(V+"delete_comment",$({name:s,password:r,comment_id:t}))).json(),await x(a)}catch(t){t.message}},async t=>{try{a=await(await fetch(V+"insert_comment_reply",$({name:s,password:r,comment_id:t,comment_reply:f}))).json(),await x(a)}catch(t){t.message}},async t=>{try{a=await(await fetch(V+"delete_comment_reply",$({name:s,password:r,comment_reply_id:t}))).json(),await x(a)}catch(t){t.message}},async(t,e)=>{try{n(7,h=e||m.value),a=await(await fetch(V+"insert_tag",$({name:s,password:r,link_id:t,tag:h}))).json(),await x(a)}catch(t){t.message}},A,E,C,R,j,function(){s=this.value,n(2,s)},function(){r=this.value,n(3,r)},function(){i=this.value,n(4,i)},()=>v({}),()=>C(),()=>E(),t=>R(t.tag),function(t){k[t?"unshift":"push"]((()=>{m=t,n(9,m)}))},function(){h=this.value,n(7,h)},t=>j(t.username),function(){u=this.value,n(5,u)},(t,e)=>j(t[e].username),function(){f=this.value,n(6,f)},t=>j(t.username),()=>l()]}return new class extends N{constructor(t){super(),D(this,t,K,J,a,{},null,[-1,-1,-1])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
