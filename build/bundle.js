var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function l(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode&&t.parentNode.removeChild(t)}function i(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function f(){return p(" ")}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function d(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e){e=""+e,t.data!==e&&(t.data=e)}function _(t,e){t.value=null==e?"":e}let g;function y(t){g=t}function x(t){(function(){if(!g)throw new Error("Function called outside component initialization");return g})().$$.on_mount.push(t)}const w=[],E=[];let b=[];const $=[],v=Promise.resolve();let k=!1;function j(t){b.push(t)}const O=new Set;let C=0;function S(){if(0!==C)return;const t=g;do{try{for(;C<w.length;){const t=w[C];C++,y(t),D(t.$$)}}catch(t){throw w.length=0,C=0,t}for(y(null),w.length=0,C=0;E.length;)E.pop()();for(let t=0;t<b.length;t+=1){const e=b[t];O.has(e)||(O.add(e),e())}b.length=0}while(w.length);for(;$.length;)$.pop()();k=!1,O.clear(),y(t)}function D(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(j)}}const A=new Set;function T(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];b.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),b=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function M(t,e){-1===t.$$.dirty[0]&&(w.push(t),k||(k=!0,v.then(S)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function L(c,r,s,i,u,p,f,h=[-1]){const d=g;y(c);const m=c.$$={fragment:null,ctx:[],props:p,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(d?d.$$.context:[])),callbacks:n(),dirty:h,skip_bound:!1,root:r.target||d.$$.root};f&&f(m.root);let _=!1;if(m.ctx=s?s(c,r.props||{},((t,e,...n)=>{const o=n.length?n[0]:e;return m.ctx&&u(m.ctx[t],m.ctx[t]=o)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](o),_&&M(c,t)),e})):[],m.update(),_=!0,o(m.before_update),m.fragment=!!i&&i(m.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);m.fragment&&m.fragment.l(t),t.forEach(a)}else m.fragment&&m.fragment.c();r.intro&&((x=c.$$.fragment)&&x.i&&(A.delete(x),x.i(w))),function(t,n,c,r){const{fragment:s,after_update:a}=t.$$;s&&s.m(n,c),r||j((()=>{const n=t.$$.on_mount.map(e).filter(l);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),a.forEach(j)}(c,r.target,r.anchor,r.customElement),S()}var x,w;y(d)}class q{$destroy(){T(this,1),this.$destroy=t}$on(e,n){if(!l(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function N(t,e,n){const o=t.slice();return o[59]=e[n],o[61]=n,o}function U(t,e,n){const o=t.slice();return o[62]=e[n],o[64]=n,o}function P(t,e,n){const o=t.slice();return o[65]=e[n],o[64]=n,o}function K(t,e,n){const o=t.slice();return o[59]=e[n],o[61]=n,o}function B(t,e,n){const o=t.slice();return o[68]=e[n],o[64]=n,o}function Y(e){let n,o,l;return{c(){n=u("button"),n.textContent="remove_error_message"},m(t,c){s(t,n,c),o||(l=h(n,"click",e[22]),o=!0)},p:t,d(t){t&&a(n),o=!1,l()}}}function Q(t){let e,n,o,l=t[68].tag+"";return{c(){e=u("span"),n=p(l),o=p(", ")},m(t,l){s(t,e,l),r(e,n),r(e,o)},p(t,e){1&e[0]&&l!==(l=t[68].tag+"")&&m(n,l)},d(t){t&&a(e)}}}function G(e){let n;return{c(){n=u("span"),n.textContent="😇"},m(t,e){s(t,n,e)},p:t,d(t){t&&a(n)}}}function z(t){let e,n,o,c,i,d,_,g,y,x,w,E,b=t[65].reply+"",$=t[65].username+"";return{c(){e=u("li"),n=p("reply: "),o=p(b),c=f(),i=u("li"),d=p("username: "),_=p($),g=f(),y=u("button"),y.textContent="fetch_delete_comment_reply",x=f()},m(a,u){s(a,e,u),r(e,n),r(e,o),s(a,c,u),s(a,i,u),r(i,d),r(i,_),s(a,g,u),s(a,y,u),s(a,x,u),w||(E=h(y,"click",(function(){l(t[21](t[65].id))&&t[21](t[65].id).apply(this,arguments)})),w=!0)},p(e,n){t=e,1&n[0]&&b!==(b=t[65].reply+"")&&m(o,b),1&n[0]&&$!==($=t[65].username+"")&&m(_,$)},d(t){t&&a(e),t&&a(c),t&&a(i),t&&a(g),t&&a(y),t&&a(x),w=!1,E()}}}function F(t){let e,n,c,g,y,x,w,E,b,$,v,k,R,j,O,C,S,D,A,T,M,L,q,N,U,K,B,Y,Q=t[62][t[64]].comment+"",G=t[62][t[64]].created_at+"",F=t[62][t[64]].updated_at+"",J=t[62][t[64]].username+"",H=t[62].comment_replies,I=[];for(let e=0;e<H.length;e+=1)I[e]=z(P(t,H,e));return{c(){e=u("li"),n=p("comment: "),c=p(Q),g=f(),y=u("li"),x=p("created_at: "),w=p(G),E=f(),b=u("button"),b.textContent="fetch_delete_comment",$=f(),v=u("li"),k=p("updated_at: "),R=p(F),j=f(),O=u("li"),C=p("username: "),S=p(J),D=f(),A=u("input"),T=f(),M=u("button"),M.textContent="fetch_insert_comment_reply",L=f(),q=u("li"),N=p("comment_replies:\n\t\t\t\t"),U=u("ul");for(let t=0;t<I.length;t+=1)I[t].c();K=f(),d(A,"type","text"),d(A,"placeholder","comment_reply"),d(q,"class","reply_zone svelte-1bjmpqx")},m(o,a){s(o,e,a),r(e,n),r(e,c),s(o,g,a),s(o,y,a),r(y,x),r(y,w),s(o,E,a),s(o,b,a),s(o,$,a),s(o,v,a),r(v,k),r(v,R),s(o,j,a),s(o,O,a),r(O,C),r(O,S),s(o,D,a),s(o,A,a),_(A,t[6]),s(o,T,a),s(o,M,a),s(o,L,a),s(o,q,a),r(q,N),r(q,U);for(let t=0;t<I.length;t+=1)I[t]&&I[t].m(U,null);s(o,K,a),B||(Y=[h(b,"click",(function(){l(t[19](t[62][t[64]].id))&&t[19](t[62][t[64]].id).apply(this,arguments)})),h(A,"input",t[37]),h(M,"click",(function(){l(t[20](t[62][t[64]].id))&&t[20](t[62][t[64]].id).apply(this,arguments)}))],B=!0)},p(e,n){if(t=e,1&n[0]&&Q!==(Q=t[62][t[64]].comment+"")&&m(c,Q),1&n[0]&&G!==(G=t[62][t[64]].created_at+"")&&m(w,G),1&n[0]&&F!==(F=t[62][t[64]].updated_at+"")&&m(R,F),1&n[0]&&J!==(J=t[62][t[64]].username+"")&&m(S,J),64&n[0]&&A.value!==t[6]&&_(A,t[6]),2097153&n[0]){let e;for(H=t[62].comment_replies,e=0;e<H.length;e+=1){const o=P(t,H,e);I[e]?I[e].p(o,n):(I[e]=z(o),I[e].c(),I[e].m(U,null))}for(;e<I.length;e+=1)I[e].d(1);I.length=H.length}},d(t){t&&a(e),t&&a(g),t&&a(y),t&&a(E),t&&a(b),t&&a($),t&&a(v),t&&a(j),t&&a(O),t&&a(D),t&&a(A),t&&a(T),t&&a(M),t&&a(L),t&&a(q),i(I,t),t&&a(K),B=!1,o(Y)}}}function J(t){let e,n,c,g,y,x,w,E,b,$,v,k,R,j,O,C,S,D,A,T,M,L,q,N,P,Y,z,J,H=t[59].link+"",I=t[59].created_at+"",V=t[59].username+"",W=t[59].tags,X=[];for(let e=0;e<W.length;e+=1)X[e]=Q(B(t,W,e));let Z=Array(t[59].like_count),tt=[];for(let e=0;e<Z.length;e+=1)tt[e]=G(K(t,Z,e));let et=t[59].comments_and_replies,nt=[];for(let e=0;e<et.length;e+=1)nt[e]=F(U(t,et,e));return{c(){e=u("li"),n=u("div"),c=p("tag: \n\t\t\t");for(let t=0;t<X.length;t+=1)X[t].c();g=f(),y=u("a"),x=p(H),E=f(),b=u("div"),$=p("created_at: "),v=p(I),k=f(),R=u("div"),j=p("username: "),O=p(V),C=f();for(let t=0;t<tt.length;t+=1)tt[t].c();S=f(),D=u("button"),D.textContent="like_increment_or_decrement",A=f(),T=u("div"),M=u("input"),L=f(),q=u("button"),q.textContent="fetch_insert_comment",N=f(),P=u("ul");for(let t=0;t<nt.length;t+=1)nt[t].c();Y=f(),d(n,"class","svelte-1bjmpqx"),d(y,"href",w=t[59].link),d(y,"target","_blank"),d(b,"class","svelte-1bjmpqx"),d(R,"class","svelte-1bjmpqx"),d(M,"type","text"),d(M,"name",""),d(M,"id",""),d(M,"placeholder","comment"),d(T,"class","svelte-1bjmpqx"),d(P,"class","comment_zone svelte-1bjmpqx")},m(o,a){s(o,e,a),r(e,n),r(n,c);for(let t=0;t<X.length;t+=1)X[t]&&X[t].m(n,null);r(e,g),r(e,y),r(y,x),r(e,E),r(e,b),r(b,$),r(b,v),r(e,k),r(e,R),r(R,j),r(R,O),r(e,C);for(let t=0;t<tt.length;t+=1)tt[t]&&tt[t].m(e,null);r(e,S),r(e,D),r(e,A),r(e,T),r(T,M),_(M,t[5]),r(T,L),r(T,q),r(e,N),r(e,P);for(let t=0;t<nt.length;t+=1)nt[t]&&nt[t].m(P,null);r(e,Y),z||(J=[h(D,"click",(function(){l(t[17](t[59].id))&&t[17](t[59].id).apply(this,arguments)})),h(M,"input",t[36]),h(q,"click",(function(){l(t[18](t[59].id))&&t[18](t[59].id).apply(this,arguments)}))],z=!0)},p(o,l){if(t=o,1&l[0]){let e;for(W=t[59].tags,e=0;e<W.length;e+=1){const o=B(t,W,e);X[e]?X[e].p(o,l):(X[e]=Q(o),X[e].c(),X[e].m(n,null))}for(;e<X.length;e+=1)X[e].d(1);X.length=W.length}if(1&l[0]&&H!==(H=t[59].link+"")&&m(x,H),1&l[0]&&w!==(w=t[59].link)&&d(y,"href",w),1&l[0]&&I!==(I=t[59].created_at+"")&&m(v,I),1&l[0]&&V!==(V=t[59].username+"")&&m(O,V),1&l[0]){let n;for(Z=Array(t[59].like_count),n=0;n<Z.length;n+=1){const o=K(t,Z,n);tt[n]?tt[n].p(o,l):(tt[n]=G(),tt[n].c(),tt[n].m(e,S))}for(;n<tt.length;n+=1)tt[n].d(1);tt.length=Z.length}if(32&l[0]&&M.value!==t[5]&&_(M,t[5]),3670081&l[0]){let e;for(et=t[59].comments_and_replies,e=0;e<et.length;e+=1){const n=U(t,et,e);nt[e]?nt[e].p(n,l):(nt[e]=F(n),nt[e].c(),nt[e].m(P,null))}for(;e<nt.length;e+=1)nt[e].d(1);nt.length=et.length}},d(t){t&&a(e),i(X,t),i(tt,t),i(nt,t),z=!1,o(J)}}}function H(e){let n,l,c,g,y,x,w,E,b,$,v,k,R,j,O,C,S,D,A,T,M,L,q,U,P,K,B,Q,G,z,F,H,I,V,W,X,Z,tt,et=e[7]&&Y(e),nt=e[0],ot=[];for(let t=0;t<nt.length;t+=1)ot[t]=J(N(e,nt,t));return{c(){n=u("div"),l=p(e[7]),c=f(),et&&et.c(),g=f(),y=u("div"),x=u("input"),w=f(),E=u("input"),b=f(),$=u("input"),v=f(),k=u("input"),R=f(),j=u("div"),O=u("input"),C=f(),S=u("input"),D=f(),A=u("input"),T=f(),M=u("input"),L=f(),q=u("button"),q.textContent="insert_link",U=f(),P=u("div"),K=u("button"),K.textContent="test_db_init_on_start",B=f(),Q=u("button"),Q.textContent="test_db_init_on_end",G=f(),z=u("button"),z.textContent="test_sample_exe",F=f(),H=u("button"),H.textContent="clear condition",I=f(),V=u("button"),V.textContent="user2",W=f(),X=u("ul");for(let t=0;t<ot.length;t+=1)ot[t].c();d(n,"class","svelte-1bjmpqx"),d(x,"type","text"),d(x,"placeholder","ORDER_BY"),d(E,"type","text"),d(E,"placeholder","ORDER_BY_COLUMN"),d($,"type","text"),d($,"placeholder","REQ_TAG"),d(k,"type","text"),d(k,"placeholder","USER"),d(y,"class","svelte-1bjmpqx"),d(O,"type","text"),d(O,"placeholder","name"),d(S,"type","text"),d(S,"placeholder","password"),d(A,"type","text"),d(A,"placeholder","TEST_MODE"),d(M,"type","text"),d(M,"placeholder","link_url"),d(M,"class","link"),d(q,"class","insert_link"),d(j,"class","svelte-1bjmpqx"),d(P,"class","svelte-1bjmpqx")},m(t,o){s(t,n,o),r(n,l),r(n,c),et&&et.m(n,null),s(t,g,o),s(t,y,o),r(y,x),_(x,e[8]),r(y,w),r(y,E),_(E,e[9]),r(y,b),r(y,$),_($,e[10]),r(y,v),r(y,k),_(k,e[11]),s(t,R,o),s(t,j,o),r(j,O),_(O,e[1]),r(j,C),r(j,S),_(S,e[3]),r(j,D),r(j,A),_(A,e[2]),r(j,T),r(j,M),_(M,e[4]),r(j,L),r(j,q),s(t,U,o),s(t,P,o),r(P,K),r(P,B),r(P,Q),r(P,G),r(P,z),r(P,F),r(P,H),r(P,I),r(P,V),s(t,W,o),s(t,X,o);for(let t=0;t<ot.length;t+=1)ot[t]&&ot[t].m(X,null);Z||(tt=[h(x,"input",e[23]),h(E,"input",e[24]),h($,"input",e[25]),h(k,"input",e[26]),h(O,"input",e[27]),h(S,"input",e[28]),h(A,"input",e[29]),h(M,"input",e[30]),h(q,"click",e[16]),h(K,"click",e[31]),h(Q,"click",e[32]),h(z,"click",e[33]),h(H,"click",e[34]),h(V,"click",e[35])],Z=!0)},p(t,e){if(128&e[0]&&m(l,t[7]),t[7]?et?et.p(t,e):(et=Y(t),et.c(),et.m(n,null)):et&&(et.d(1),et=null),256&e[0]&&x.value!==t[8]&&_(x,t[8]),512&e[0]&&E.value!==t[9]&&_(E,t[9]),1024&e[0]&&$.value!==t[10]&&_($,t[10]),2048&e[0]&&k.value!==t[11]&&_(k,t[11]),2&e[0]&&O.value!==t[1]&&_(O,t[1]),8&e[0]&&S.value!==t[3]&&_(S,t[3]),4&e[0]&&A.value!==t[2]&&_(A,t[2]),16&e[0]&&M.value!==t[4]&&_(M,t[4]),4063329&e[0]){let n;for(nt=t[0],n=0;n<nt.length;n+=1){const o=N(t,nt,n);ot[n]?ot[n].p(o,e):(ot[n]=J(o),ot[n].c(),ot[n].m(X,null))}for(;n<ot.length;n+=1)ot[n].d(1);ot.length=nt.length}},i:t,o:t,d(t){t&&a(n),et&&et.d(),t&&a(g),t&&a(y),t&&a(R),t&&a(j),t&&a(U),t&&a(P),t&&a(W),t&&a(X),i(ot,t),Z=!1,o(tt)}}}function I(t,e,n){let o,l=[],c="user1",r="TEST_MODE",s="user_pass1",a="https://yanaka.dev/",i="comment1",u="reply1",p="",f="",h="DESC",d="links.id",m="",_="";const g=async()=>{try{n(1,c="testuser"),n(3,s="duct_mean_fuckst1ck"),n(2,r="TEST_MODE"),o=await(await fetch("http://localhost:8000/test_db_init",O({name:c,password:s,test_mode:r}))).json(),"fail"===o.result&&(()=>{throw new Error(o.error)})(),console.log(o.result)}catch(t){n(7,p=t.message)}},y=async()=>{try{n(1,c="testuser"),n(3,s="duct_mean_fuckst1ck"),n(2,r="TEST_MODE"),o=await(await fetch("http://localhost:8000/test_db_init",O({name:c,password:s,test_mode:r}))).json(),"fail"===o.result&&(()=>{throw new Error(o.error)})(),console.log(o.result)}catch(t){n(7,p=t.message)}};let w=[],E=[];const b=async({Data:t="SELECT",Exe_fn:e=S,Expect_result:o="SQLの予約語を含む場合はエラー"})=>{n(4,a=t),await e(),"success"===f&&(console.log("OK"),E.push(["OK",t+"はOK"])),p===o?(console.log("OK"),w.push(["OK",o])):console.log("NG")},$=async()=>{await g(),await b({Data:"SELECT",Exe_fn:S,Expect_result:"SQLの予約語を含む場合はエラー"}),await b({Data:"https::///google.co.jp",Exe_fn:S,Expect_result:"URLの形式が正しくありません"}),await b({Data:"https://google.co.jp/".repeat(1e3),Exe_fn:S,Expect_result:"URLが長すぎます"}),await b({Data:"https://hogehoge.com/",Exe_fn:S,Expect_result:"許可されていないURLです"}),await b({Data:"https://www.yahoo.co.jp/",Exe_fn:S,Expect_result:"OK"}),await b({Data:"https://www.google.co.jp/",Exe_fn:S,Expect_result:"OK"}),await b({Data:"https://www.youtube.com/",Exe_fn:S,Expect_result:"OK"}),await b({Data:"https://www.google.co.jp/",Exe_fn:S,Expect_result:"同じlinkが存在します"}),console.log(w),console.log(E),await y()},v=R.xprod(["tag1","tag2","tag3"],["user1","user2","user3"]),k=R.xprod(["links.id","like_count"],v);R.xprod(["DESC","ASC"],k).map((t=>R.flatten(t))).map((t=>({ORDER_BY:t[0],ORDER_BY_COLUMN:t[1],REQ_TAG:t[2],USER:t[3]})));const j=async({ORDER_BY_PARAM:t="DESC",ORDER_BY_COLUMN_PARAM:e="links.id",REQ_TAG_PARAM:o,USER_PARAM:c})=>{try{console.log(t,e,o,c),n(8,h=t),n(9,d=e),n(10,m=o),n(11,_=c);const r=()=>{const t=[];h&&t.push(`order_by=${h}`),d&&t.push(`order_by_column=${d}`),m&&t.push(`tag=${m}`),_&&t.push(`user=${_}`);return`http://localhost:8000/read_all?${t.join("&")}`},s=await(await fetch(r())).json();if("fail"===s.result)throw new Error(s.error);const a=await(await fetch(r())).json();if(0===a.length)throw new Error("条件に一致するデータがありませんでした");n(0,l=a)}catch(t){console.log(t),n(7,p=t.message)}},O=t=>({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});let C=null;const S=async()=>{try{o=await(await fetch("http://localhost:8000/insert_link",O({name:c,password:s,link:a}))).json(),console.log(o),C=o.text(),400===o.status&&console.log("RESPONSE.status: RESPONSE.status === 400"),200===o.status&&(f=o.result),"fail"===o.result?(()=>{throw new Error(o.message)})():j({}),console.log(o.result)}catch(t){n(7,p=t.message),console.log(t),console.log(t.message)}};x((async()=>{try{await j({})}catch(t){console.log(t)}}));return[l,c,r,s,a,i,u,p,h,d,m,_,g,y,$,j,S,async t=>o=(await fetch("http://localhost:8000/like_increment_or_decrement",O({name:c,password:s,link_id:t}))).json(),async t=>o=(await fetch("http://localhost:8000/insert_comment",O({name:c,password:s,link_id:t,comment:i}))).json(),async t=>o=(await fetch("http://localhost:8000/delete_comment",O({name:c,password:s,comment_id:t}))).json(),async t=>o=(await fetch("http://localhost:8000/insert_comment_reply",O({name:c,password:s,comment_id:t,comment_reply:u}))).json(),async t=>o=(await fetch("http://localhost:8000/delete_comment_reply",O({name:c,password:s,comment_reply_id:t}))).json(),()=>n(7,p=""),function(){h=this.value,n(8,h)},function(){d=this.value,n(9,d)},function(){m=this.value,n(10,m)},function(){_=this.value,n(11,_)},function(){c=this.value,n(1,c)},function(){s=this.value,n(3,s)},function(){r=this.value,n(2,r)},function(){a=this.value,n(4,a)},()=>g(),()=>y(),()=>$(),()=>j({}),()=>j({USER_PARAM:"user2"}),function(){i=this.value,n(5,i)},function(){u=this.value,n(6,u)}]}return new class extends q{constructor(t){super(),L(this,t,I,H,c,{},null,[-1,-1,-1])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
